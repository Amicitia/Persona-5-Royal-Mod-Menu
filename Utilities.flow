
import( "Utilities.msg" );
import( "Math.flow" );

int SelectDigit()
{
    while ( true )
	{
        SEL_MASK(1);
		int temp = SEL_GENERIC(-1, Select0to4Dialog ) - 1;
        if ( temp == -1 )
            break;
            
		if ( temp == 5 ) // higher
		{
            SEL_MASK(1);
			temp = SEL_GENERIC(-1, Select5to9Dialog ) - 1;
            if ( temp == -1 )
                break;
                
			if ( temp == 5 ) // lower
			  continue;

			return temp + 5;
		}

		return temp;
	}
	
	return -1;
}

int SelectNumber( int digitCount )
{
	int number = 0;
	
	for ( int i = 0; i < digitCount; i++ )
	{
        SEL_MASK(1);
		int digit = SEL_GENERIC(-1, Select0to9Dialog) - 1;
        
        // Number should only equal negative one if we cancel
        // before entering anything.
        if (digit < 0)
        {
            if (i < 1)
            {
                return -1;
            }
            else
            {
                number = number * PowF(10, -1 * i );
                break;
            }
        }
        
		int digitToPower = digit * Pow( 10, digitCount - ( i + 1 ) );
		number += digitToPower;
	}
	
	return number;
}

float SelectFloat( float digitCount )
{
	float number = 0;
	
	for ( float i = 0; i < digitCount; i++ )
	{
        SEL_MASK(1);
		float digit = SEL_GENERIC(-1, Select0to9Dialog) - 1;
        
        // Number should only equal one if we cancel
        // before entering anything.
        // Number should only equal negative one if we cancel
        // before entering anything.
        if (digit < 0)
        {
            if (i < 1)
            {
                return -1;
            }
            else
            {
                number = number * PowF(10, -1 * i );
                break;
            }
        }
        
		float digitToPower = digit * Pow( 10, digitCount - ( i + 1 ) );
		number += digitToPower;
	}
	
	return number;
}

void DisplayMessagePrompt( int messageId )
{
	MSG_WND_DSP(); 
	MSG( messageId, 0 ); 
	MSG_WND_CLS();
}

int SelectNumberPrompt( int messageId, int digits )
{
	DisplayMessagePrompt( messageId );
    int i = SelectNumber( digits );
    PUTS( "SelectNumber returned: " );
    PUT( i );
	return i;
}

float SelectFloatPrompt( int messageId, int digits )
{
	DisplayMessagePrompt( messageId );
    float i = SelectFloat( digits );
    PUTS( "SelectFloat returned: " );
    PUT( i );
	return i;
}

int SelectPrompt( int promptMessageId, int selectMessageId )
{
	MSG_WND_DSP(); 
	MSG( promptMessageId, 0 );
	int selection = SEL_GENERIC_NOT_CANCEL(-1, selectMessageId );
	MSG_WND_CLS();
	return selection;
}

int SelectPrompt2( int promptMessageId, int selectMessageId )
{
	MSG_WND_DSP(); 
	MSG( promptMessageId, 0 );
	int selection = SEL_GENERIC_NOT_CANCEL(-1, selectMessageId );
	MSG_WND_CLS();
	return selection;
}
